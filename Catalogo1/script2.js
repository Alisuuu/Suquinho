window.App=window.App||{};App.API=App.API||{};App.API.fetchMultiplePages=async(e,t={},s=2)=>{let a=[];const r=[];for(let i=1;i<=s;i++)r.push(fetch(`${App.Constants.TMDB_BASE_URL}/${e}?${new URLSearchParams({api_key:App.Constants.TMDB_API_KEY,language:'pt-BR',page:i,...t})}`).then(e=>{if(!e.ok)throw new Error(`HTTP error! Status: ${e.status} ${e.statusText} for ${e.url}`);return e.json()}));try{const e=await Promise.all(r);return e.forEach(e=>{e?.results&& (a=a.concat(e.results))}),a=a.filter((e,t,s)=>t===s.findIndex(t=>t.id===e.id)),{results:a}}catch(e){throw console.error(`Failed to fetch multiple pages for ${e}:`,e),e}};App.API.fetchItemDetailsFromApi=async(e,t)=>{const s=`${t}/${e}`,a='tv'===t?'videos,external_ids,aggregate_credits':'videos,external_ids',r=new URLSearchParams({api_key:App.Constants.TMDB_API_KEY,language:'pt-BR',append_to_response:a});try{const e=await fetch(`${App.Constants.TMDB_BASE_URL}/${s}?${r}`);if(!e.ok)throw new Error(`HTTP error! Status: ${e.status} ${e.statusText} for ${e.url}`);return await e.json()}catch(e){throw console.error(`Failed to fetch item details for ${t}/${e}:`,e),e}};App.API.fetchSeasonDetailsFromApi=async(e,t)=>{const s=`tv/${e}/season/${t}`,a=new URLSearchParams({api_key:App.Constants.TMDB_API_KEY,language:'pt-BR'});try{const e=await fetch(`${App.Constants.TMDB_BASE_URL}/${s}?${a}`);if(!e.ok)throw new Error(`HTTP error! Status: ${e.status} ${e.statusText} for ${e.url}`);return await e.json()}catch(e){throw console.error(`Failed to fetch season ${t} for TV ID ${e}:`,e),e}};App.API.fetchSuperflixMovieStream=async e=>{try{const t=await fetch(`${App.Constants.SUPERFLIX_BASE_URL}/filme/${e}`);if(!t.ok)throw new Error(`Superflix API error! Status: ${t.status} ${t.statusText}`);const s=await t.json();return s.video_url||s.embed_url||null}catch(t){return console.error(`Failed to fetch Superflix movie stream for TMDB ID ${e}:`,t),null}};App.API.fetchSuperflixEpisodeStream=async(e,t,s)=>{try{const a=await fetch(`${App.Constants.SUPERFLIX_BASE_URL}/serie/${e}/temporada/${t}/episodio/${s}`);if(!a.ok)throw new Error(`Superflix API error! Status: ${a.status} ${a.statusText}`);const r=await a.json();return r.video_url||r.embed_url||null}catch(a){return console.error(`Failed to fetch Superflix episode stream for TMDB ID ${e}, S${t} E${s}:`,a),null}};App.API.fetchSuperflixChannels=async()=>{try{const e=await fetch(`${App.Constants.SUPERFLIX_BASE_URL}/canais`);if(!e.ok)throw new Error(`Superflix API error! Status: ${e.status} ${e.statusText}`);return await e.json()}catch(e){return console.error('Failed to fetch Superflix channels:',e),[]}};
